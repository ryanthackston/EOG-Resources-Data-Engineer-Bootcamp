WITH wells AS (
	SELECT
		/*+ PARALLEL(c2, 16) PARALLEL(p2, 16) */
		c2.well_id, 
		c2.division_id
		FROM ODM_INFO.ODM_COMPLETION c2
		JOIN ODM_DBA.ODM_COMP_PRODUCTION p2 ON c2.COMPLETION_ID = p2.COMPLETION_ID AND c2.DIVISION_ID = p2.DIVISION_ID 
		WHERE EXTRACT(YEAR FROM p2.DATE_VALUE) >= 2016
		AND c2.DIVISION_ID IN (10, 63)
		AND ((p2.GROSS_GAS_PROD > 0) OR (p2.GROSS_OIL_PROD > 0))
		AND c2.WELL_DIRECTION = 'HOR'
		GROUP BY 
			c2.well_id, 
			c2.division_id
		HAVING 
			EXTRACT(YEAR FROM min(p2.DATE_VALUE)) >= 2016
)
SELECT /*+ PARALLEL(D, 16)*/ 
	DD.*
FROM wells w
JOIN (SELECT DISTINCT AFE_NBR, WELL_ID, DIVISION_ID, perc_well_id_nbr, EVENT_NBR FROM ODM_DBA.ODM_AFE_HEADER) H
	ON w.well_id = H.well_id 
	AND w.division_id = h.DIVISION_ID 
JOIN ODM_DBA.ODM_AFE_DETAIL_DAILY DD
	ON DD.AFE_NBR = H.AFE_NBR 
	AND DD.division_id = h.DIVISION_ID 
	AND DD.PERC_WELL_ID_NBR = H.PERC_WELL_ID_NBR
	AND DD.EVENT_NBR = H.EVENT_NBR
    